<!DOCTYPE html>

<style>
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.box {
  font: 10px sans-serif;
}

.box line,
.box rect  {
  fill: steelblue;
  stroke: #000;
  stroke-width: 1px;
}

.box .center {
  stroke-dasharray: 3,3;
}

.box .outlier {
  fill: none;
  stroke: #000;
}

.axis {
  font: 12px sans-serif;
}

.y1-label{
  text-shadow: 0px 0px 4px white, 0px 0px 6px white, 0px 0px 8px white;
  fill: black;
  font-weight: bold;
}

.y2-label{
  text-shadow: 0px 0px 4px white, 0px 0px 6px white, 0px 0px 8px white;
  fill: darkred;
  font-weight: bold;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
 
.circle,
.y2.axis{
  color: tomato;
  fill: tomato;
}

.x.axis path { 
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.line {
  fill: none;
  stroke: tomato;
  stroke-width: 1.5px;
}

.label-nodata{
	font-weight: bold;
	text-align: center;
}
</style>
<body>

<script src="d3.box.v3.min.js"></script>

<h1>Disk performances on a SQL Server workload</h1>
<i>DiskBenchmark_MSSQL.ps1 v0.5b</i>

<h2>Disk performance for SQL Server Read-Ahead</h2>
<h3>diskspd parameters :</h3>
<h4>Function Read-Ahead parameters : -c1G -d10 -w0 -b2M -r -h -W -o4 -t32 -h -L F:\\diskspd_tmp.dat</h4>
<div id="chart_DRA_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_DRA_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 324.61, 649.21];
iops_data[1] = ["Run 1", 359.30, 718.60];
iops_data[2] = ["Run 2", 361.41, 722.82];
iops_data[3] = ["Run 3", 331.59, 663.18];
iops_data[4] = ["Run 4", 341.10, 682.20];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_DRA_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;

	var Latency_data = [];

	Latency_data[0] = ["Run 0", [17.279, 220.547, 282.204, 344.690, 4602.419]];
Latency_data[1] = ["Run 1", [13.013, 212.480, 278.736, 351.929, 4008.338]];
Latency_data[2] = ["Run 2", [11.234, 204.710, 293.884, 328.104, 3954.412]];
Latency_data[3] = ["Run 3", [9.273, 211.241, 304.800, 369.461, 4341.877]];
Latency_data[4] = ["Run 4", [10.128, 200.597, 286.677, 374.182, 4327.493]];


if (Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_DRA_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");	

	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_DRA_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>

<h2>Disk performance for SQL Server Lazy Writer</h2>
<h3>diskspd parameters :</h3>
<h4>Function Lazy Writer parameters : -c1G -d10 -w100 -b64K -r -h -W -o4 -t32 -h -L F:\\diskspd_tmp.dat</h4>
<div id="chart_DLW_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_DLW_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 3388.83, 211.80];
iops_data[1] = ["Run 1", 3401.82, 212.61];
iops_data[2] = ["Run 2", 3181.70, 198.86];
iops_data[3] = ["Run 3", 3222.31, 201.39];
iops_data[4] = ["Run 4", 3243.86, 202.74];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_DLW_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;
	
	var Latency_data = [];
	
	Latency_data[0] = ["Run 0", [1.514, 30.702, 33.202, 36.764, 133.330]];
Latency_data[1] = ["Run 1", [1.291, 31.416, 33.174, 35.431, 179.216]];
Latency_data[2] = ["Run 2", [1.456, 30.875, 32.573, 34.988, 201.809]];
Latency_data[3] = ["Run 3", [1.562, 30.885, 32.529, 35.715, 177.748]];
Latency_data[4] = ["Run 4", [1.474, 30.551, 32.347, 34.665, 221.114]];

	

if (Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_DLW_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_DLW_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>

<h2>Disk performance for SQL Server Log Writer</h2>
<h3>diskspd parameters :</h3>
<h4>Function Log Writer parameters : -c1G -d10 -w100 -b64K -h -W -o4 -t1 -h -L H:\\diskspd_tmp.dat</h4>
<div id="chart_LWR_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_LWR_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 2496.66, 156.04];
iops_data[1] = ["Run 1", 2520.47, 157.53];
iops_data[2] = ["Run 2", 1639.99, 102.50];
iops_data[3] = ["Run 3", 2285.09, 142.82];
iops_data[4] = ["Run 4", 1145.97, 71.62];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_LWR_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;
	
	var Latency_data = [];
	
	Latency_data[0] = ["Run 0", [0.684, 1.162, 1.374, 1.714, 4.908]];
Latency_data[1] = ["Run 1", [0.672, 1.138, 1.339, 1.693, 4.495]];
Latency_data[2] = ["Run 2", [0.683, 1.156, 1.382, 2.347, 11.355]];
Latency_data[3] = ["Run 3", [0.683, 1.136, 1.347, 1.746, 7.673]];
Latency_data[4] = ["Run 4", [0.703, 1.205, 1.575, 4.491, 14.948]];

if(Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_LWR_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_LWR_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
