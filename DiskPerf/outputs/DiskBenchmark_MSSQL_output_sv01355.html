<!DOCTYPE html>

<style>
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.box {
  font: 10px sans-serif;
}

.box line,
.box rect  {
  fill: steelblue;
  stroke: #000;
  stroke-width: 1px;
}

.box .center {
  stroke-dasharray: 3,3;
}

.box .outlier {
  fill: none;
  stroke: #000;
}

.axis {
  font: 12px sans-serif;
}

.y1-label{
  text-shadow: 0px 0px 4px white, 0px 0px 6px white, 0px 0px 8px white;
  fill: black;
  font-weight: bold;
}

.y2-label{
  text-shadow: 0px 0px 4px white, 0px 0px 6px white, 0px 0px 8px white;
  fill: darkred;
  font-weight: bold;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
 
.circle,
.y2.axis{
  color: tomato;
  fill: tomato;
}

.x.axis path { 
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.line {
  fill: none;
  stroke: tomato;
  stroke-width: 1.5px;
}

.label-nodata{
	font-weight: bold;
	text-align: center;
}
</style>
<body>

<script src="d3.box.v3.min.js"></script>

<h1>Disk performances on a SQL Server workload</h1>
<i>DiskBenchmark_MSSQL.ps1 v0.5</i>

<h2>Disk performance for SQL Server Read-Ahead</h2>
<h3>diskspd parameters :</h3>
<h4>Function Read-Ahead parameters : -c1G -d60 -w0 -b2M -r -h -W -o4 -t32 -h -L D:\diskspd_tmp.dat</h4>
<div id="chart_DRA_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_DRA_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 931.09, 1862.18];
iops_data[1] = ["Run 1", 942.55, 1885.11];
iops_data[2] = ["Run 2", 890.03, 1780.06];
iops_data[3] = ["Run 3", 938.43, 1876.86];
iops_data[4] = ["Run 4", 916.56, 1833.12];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_DRA_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;

	var Latency_data = [];

	Latency_data[0] = ["Run 0", [7.073, 128.386, 134.119, 140.754, 164.399]];
Latency_data[1] = ["Run 1", [5.699, 126.183, 132.450, 140.359, 167.433]];
Latency_data[2] = ["Run 2", [3.053, 134.482, 141.905, 149.473, 168.401]];
Latency_data[3] = ["Run 3", [6.347, 127.816, 132.451, 137.655, 159.758]];
Latency_data[4] = ["Run 4", [6.868, 131.650, 137.240, 142.933, 168.932]];


if (Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_DRA_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");	

	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_DRA_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>

<h2>Disk performance for SQL Server Lazy Writer</h2>
<h3>diskspd parameters :</h3>
<h4>Function Lazy Writer parameters : -c1G -d60 -w100 -b64K -r -h -W -o4 -t32 -h -L D:\diskspd_tmp.dat</h4>
<div id="chart_DLW_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_DLW_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 9358.65, 584.92];
iops_data[1] = ["Run 1", 8958.51, 559.91];
iops_data[2] = ["Run 2", 9286.25, 580.39];
iops_data[3] = ["Run 3", 9065.61, 566.60];
iops_data[4] = ["Run 4", 9049.92, 565.62];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_DLW_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;
	
	var Latency_data = [];
	
	Latency_data[0] = ["Run 0", [1.334, 11.665, 12.411, 13.489, 38.401]];
Latency_data[1] = ["Run 1", [1.139, 11.657, 12.425, 13.700, 48.016]];
Latency_data[2] = ["Run 2", [1.318, 11.855, 12.576, 13.628, 34.713]];
Latency_data[3] = ["Run 3", [1.331, 11.655, 12.393, 13.530, 48.014]];
Latency_data[4] = ["Run 4", [1.093, 11.684, 12.518, 13.817, 46.210]];

	

if (Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_DLW_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_DLW_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>

<h2>Disk performance for SQL Server Log Writer</h2>
<h3>diskspd parameters :</h3>
<h4>Function Log Writer parameters : -c1G -d60 -w100 -b64K -h -W -o4 -t1 -h -L D:\diskspd_tmp.dat</h4>
<div id="chart_LWR_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_LWR_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 2324.89, 145.31];
iops_data[1] = ["Run 1", 2341.55, 146.35];
iops_data[2] = ["Run 2", 2360.22, 147.51];
iops_data[3] = ["Run 3", 2345.99, 146.62];
iops_data[4] = ["Run 4", 2158.45, 134.90];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_LWR_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;
	
	var Latency_data = [];
	
	Latency_data[0] = ["Run 0", [0.936, 1.305, 1.418, 1.580, 4.563]];
Latency_data[1] = ["Run 1", [0.923, 1.312, 1.430, 1.609, 4.557]];
Latency_data[2] = ["Run 2", [0.948, 1.289, 1.398, 1.549, 3.997]];
Latency_data[3] = ["Run 3", [0.936, 1.296, 1.403, 1.548, 4.332]];
Latency_data[4] = ["Run 4", [0.959, 1.365, 1.503, 1.748, 5.222]];

if(Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_LWR_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_LWR_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
