<!DOCTYPE html>

<style>
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}

.box {
  font: 10px sans-serif;
}

.box line,
.box rect  {
  fill: steelblue;
  stroke: #000;
  stroke-width: 1px;
}

.box .center {
  stroke-dasharray: 3,3;
}

.box .outlier {
  fill: none;
  stroke: #000;
}

.axis {
  font: 12px sans-serif;
}

.y1-label{
  text-shadow: 0px 0px 4px white, 0px 0px 6px white, 0px 0px 8px white;
  fill: black;
  font-weight: bold;
}

.y2-label{
  text-shadow: 0px 0px 4px white, 0px 0px 6px white, 0px 0px 8px white;
  fill: darkred;
  font-weight: bold;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
 
.circle,
.y2.axis{
  color: tomato;
  fill: tomato;
}

.x.axis path { 
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.line {
  fill: none;
  stroke: tomato;
  stroke-width: 1.5px;
}

.label-nodata{
	font-weight: bold;
	text-align: center;
}
</style>
<body>

<script src="d3.box.v3.min.js"></script>

<h1>Disk performances on a SQL Server workload</h1>
<i>DiskBenchmark_MSSQL.ps1 v0.5b</i>

<h2>Disk performance for SQL Server Read-Ahead</h2>
<h3>diskspd parameters :</h3>
<h4>Function Read-Ahead parameters : -c1G -d10 -w0 -b2M -r -h -W -o64 -t32 -h -L D:\diskspd_tmp.dat</h4>
<div id="chart_DRA_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_DRA_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 4349.10, 8698.21];
iops_data[1] = ["Run 1", 4267.61, 8535.21];
iops_data[2] = ["Run 2", 4618.09, 9236.19];
iops_data[3] = ["Run 3", 4182.56, 8365.13];
iops_data[4] = ["Run 4", 4154.96, 8309.93];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_DRA_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;

	var Latency_data = [];

	Latency_data[0] = ["Run 0", [11.844, 416.340, 465.995, 498.706, 870.305]];
Latency_data[1] = ["Run 1", [7.282, 395.017, 488.327, 529.384, 1351.802]];
Latency_data[2] = ["Run 2", [14.762, 131.976, 458.006, 514.217, 1641.777]];
Latency_data[3] = ["Run 3", [14.431, 421.451, 486.503, 530.161, 1046.988]];
Latency_data[4] = ["Run 4", [8.978, 336.262, 518.782, 552.283, 1592.601]];


if (Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_DRA_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");	

	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_DRA_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>

<h2>Disk performance for SQL Server Lazy Writer</h2>
<h3>diskspd parameters :</h3>
<h4>Function Lazy Writer parameters : -c1G -d10 -w100 -b64K -r -h -W -o64 -t32 -h -L D:\diskspd_tmp.dat</h4>
<div id="chart_DLW_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_DLW_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 30936.87, 1933.55];
iops_data[1] = ["Run 1", 30180.79, 1886.30];
iops_data[2] = ["Run 2", 24464.39, 1529.02];
iops_data[3] = ["Run 3", 27949.16, 1746.82];
iops_data[4] = ["Run 4", 23929.69, 1495.61];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_DLW_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;
	
	var Latency_data = [];
	
	Latency_data[0] = ["Run 0", [0.800, 32.165, 38.844, 47.152, 130.716]];
Latency_data[1] = ["Run 1", [0.109, 31.860, 38.511, 47.564, 133.249]];
Latency_data[2] = ["Run 2", [0.169, 36.005, 42.291, 52.816, 163.528]];
Latency_data[3] = ["Run 3", [0.523, 55.561, 73.359, 83.591, 204.489]];
Latency_data[4] = ["Run 4", [0.146, 54.222, 67.621, 83.691, 199.339]];

	

if (Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_DLW_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_DLW_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>

<h2>Disk performance for SQL Server Log Writer</h2>
<h3>diskspd parameters :</h3>
<h4>Function Log Writer parameters : -c1G -d10 -w100 -b64K -h -W -o4 -t1 -h -L E:\diskspd_tmp.dat</h4>
<div id="chart_LWR_iops"></div>
<script>
var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;

var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .5);

var y = d3.scale.linear()
    .range([height, 0]);

var y2 = d3.scale.linear()
    .range([height, 0]);
	
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left");
	
var y2Axis = d3.svg.axis()
    .scale(y2)
    .orient("right");

var line = d3.svg.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y2(d[2]); });
	  
var svg = d3.select("#chart_LWR_iops").append("svg")
	.attr("class", "box")   
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
	var iops_data = [];
	iops_data[0] = ["Run 0", 36184.57, 2261.54];
iops_data[1] = ["Run 1", 36559.49, 2284.97];
iops_data[2] = ["Run 2", 36082.92, 2255.18];
iops_data[3] = ["Run 3", 39323.92, 2457.74];
iops_data[4] = ["Run 4", 39842.70, 2490.17];


if (iops_data.length>0){
  x.domain(iops_data.map(function(d) { return d[0]; }));
  y.domain([0,  d3.max(iops_data, function(d) { return d[1]; })*1.1]);
  y2.domain([0, d3.max(iops_data, function(d) { return d[2]; })*1.1]);

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "translate(5, 0), rotate(-90)")
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("IOPS");
  
  // add a title
  svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0)
		.attr("text-anchor", "middle")  
		.style("font-size", "18px")
		.attr("transform", "translate(0, " + -(margin.top / 2) + ")") 
		.text("Disk Troughtput");
		
  svg.selectAll(".bar")
      .data(iops_data)
    .enter().append("rect")
      .attr("class", "bar")
      .attr("x", function(d) { return x(d[0]); })
      .attr("width", x.rangeBand())
      .attr("y", function(d) { return y(d[1]); })
      .attr("height", function(d) { return height - y(d[1]); });

   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y1-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0]) + (x.rangeBand()+2);},
	         'y': function(d, i) {return y(d[1])-2;}})
	  //.attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[1];});
	  
   // Axe 2
   svg.append("g")
	.attr("class", "y2 axis")
      .attr("transform", "translate(" + width + " ,0)")	
	  .call(y2Axis)
    .append("text")
      .attr("transform", "translate(-15, 30), rotate(-90)")
      .attr("dy", ".71em")
      .text("MB/s");
   //Line graph
   svg.append("path")	
	  .datum(iops_data)
      .attr("class", "line")
	  .attr("height", height)
      .attr("d", line)
	  .attr("transform", "translate(" + (x.rangeBand() / 2) + " , 0)");
   //Line circles
   svg.append('g')
      .classed('circle-group', true)
	  .selectAll('circle')
	  .data(iops_data)
	.enter()
	  .append("circle")
      .attr("class", "circle")
      .attr("r", 3)
	  .attr({'cx': function(d, i) {return x(d[0]) + (x.rangeBand() / 2);},
	         'cy': function(d, i) {return y2(d[2]);}});	  
   // Line labels
   svg.append('g')
	  .classed('labels-group', true)
	  .selectAll('text')
	  .data(iops_data)
	.enter()
	  .append('text')
	  .classed('y2-label', true)
	  .attr("text-anchor", "right")
	  .attr({'x': function(d, i) {return x(d[0])+8;},
	         'y': function(d, i) {return y2(d[2])+20;}})
	  .attr("transform", "translate(30 , 0)")
	  .text(function(d, i){return d[2];});
}else{
	// No data to graph
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
<div id="chart_LWR_latency"></div>
<script>
// view-source:http://bl.ocks.org/jensgrubert/raw/7789216/
var labels = true; // show the text labels beside individual boxplots?

var margin = {top: 30, right: 50, bottom: 70, left: 50};
var  width = 800 - margin.left - margin.right;
var height = 400 - margin.top - margin.bottom;
	
var min_Latency_data = Infinity,
    max_Latency_data = -Infinity;
	
	var Latency_data = [];
	
	Latency_data[0] = ["Run 0", [0.052, 0.083, 0.093, 0.109, 0.401]];
Latency_data[1] = ["Run 1", [0.053, 0.083, 0.092, 0.107, 0.395]];
Latency_data[2] = ["Run 2", [0.053, 0.083, 0.093, 0.109, 0.395]];
Latency_data[3] = ["Run 3", [0.054, 0.082, 0.091, 0.105, 0.182]];
Latency_data[4] = ["Run 4", [0.053, 0.082, 0.092, 0.106, 0.187]];

if(Latency_data.length>0){
	// Compute min, max_Latency_data
	for(var i = 0; i < Latency_data.length; i++){
		var run = Latency_data[i];
		var run_min = run[1][0];
		var run_max = run[1][4];
		
		if (run_min < min_Latency_data) min_Latency_data = run_min;	
		if (run_max > max_Latency_data) max_Latency_data = run_max;
	}
	
	var chart = d3.box()
		.height(height)	
		.domain([min_Latency_data, max_Latency_data]) // All run [min, max]
		.showLabels(labels)
		.tickFormat(d3.format('.3f'));

	var svg = d3.select("#chart_LWR_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
	// the x-axis
	var x = d3.scale.ordinal()	   
		.domain( Latency_data.map(function(d) { console.log(d); return d[0] } ) )	    
		.rangeRoundBands([0 , width], 0.7, 0.3); 		

	var xAxis = d3.svg.axis()
		.scale(x)
		.orient("bottom");

	// the y-axis
	var y = d3.scale.linear()
		.domain([min_Latency_data, max_Latency_data])
		.range([height + margin.top, 0 + margin.top]);
	
	var yAxis = d3.svg.axis()
		.scale(y)
		.orient("left");

	// draw the boxplots	
	svg.selectAll(".box")	   
		.data(Latency_data)
		.enter().append("g")
		.attr("transform", function(d) { return "translate(" +  x(d[0])  + "," + margin.top + ")"; } )
		.call(chart.width(x.rangeBand())); 
	
	// add a title
	svg.append("text")
		.attr("x", (width / 2))             
		.attr("y", 0 + (margin.top / 2))
		.attr("text-anchor", "middle")  
		.style("font-size", "18px") 
		.text("Disk latency");
 
	 // draw y axis
	svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
		.append("text") // and text1
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", ".71em")
			.style("text-anchor", "end")
			.style("font-size", "12px") 
			.text("Latency (ms)");		
	
	// draw x axis	
	svg.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + (height  + margin.top + 10) + ")")
		.call(xAxis);
}else{
	// No data to graph
	var svg = d3.select("#chart_LWR_latency").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.attr("class", "box")    
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
	svg.append("line")
		.attr("x1", 5)
		.attr("y1", 5)
		.attr("x2", width)
		.attr("y2", height);
	svg.append("line")
		.attr("x1", width)
		.attr("y1", 5)
		.attr("x2", 5)
		.attr("y2", height);
	svg.append("text")
		.classed('label-nodata', true)
		.attr("width", width)
		.attr()
		.attr("transform", "translate(" + (width-40)/2 + "," + height/3 + ")")
		.text("Waiting data...");
}
</script>
